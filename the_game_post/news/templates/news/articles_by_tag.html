{% extends 'news/base.html' %}

{% block title %}–°—Ç–∞—Ç—å–∏ —Å —Ç–µ–≥–æ–º "{{ tag.name }}"{% endblock %}

{% block content %}
<div class="tag-header">
    <h2>–°—Ç–∞—Ç—å–∏ —Å —Ç–µ–≥–æ–º: <span class="tag" style="background-color: {{ tag.color }}">{{ tag.name }}</span></h2>
    <a href="{% url 'news:article_list' %}" class="back-link">‚Üê –í—Å–µ —Å—Ç–∞—Ç—å–∏</a>
</div>

<div class="content-with-sidebar">
    <div class="main-content">
        {% for article in articles %}
        <article class="article-preview">
            <h3><a href="{% url 'news:article_detail' article.slug %}">{{ article.title }}</a></h3>
            <div class="article-meta">
                <span class="date">{{ article.created_at|date:"d.m.Y" }}</span>
                <span class="author">–ê–≤—Ç–æ—Ä: {{ article.author.username }}</span>
                <span class="views">üëÅ {{ article.views }}</span>
                <span class="comments-count">üí¨ {{ article.get_comments_count }}</span>
            </div>
            
            <div class="article-tags">
                {% for tag in article.tags.all %}
                <a href="{% url 'news:articles_by_tag' tag.slug %}" class="tag" style="background-color: {{ tag.color }}">
                    {{ tag.name }}
                </a>
                {% endfor %}
            </div>
            
            {% with first_block=article.blocks.first %}
                {% if first_block.block_type == 'text' %}
                    <p>{{ first_block.content|truncatewords:30 }}</p>
                {% elif first_block.block_type == 'image' and first_block.image %}
                    <img src="{{ first_block.image.url }}" alt="{{ first_block.image_caption }}" class="preview-image">
                {% endif %}
            {% endwith %}
            
            <a href="{% url 'news:article_detail' article.slug %}" class="read-more">–ß–∏—Ç–∞—Ç—å –¥–∞–ª–µ–µ</a>
        </article>
        {% empty %}
        <div class="no-articles">
            <p>–ù–µ—Ç —Å—Ç–∞—Ç–µ–π —Å —ç—Ç–∏–º —Ç–µ–≥–æ–º.</p>
            <a href="{% url 'news:article_list' %}" class="back-link">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫–æ –≤—Å–µ–º —Å—Ç–∞—Ç—å—è–º</a>
        </div>
        {% endfor %}
    </div>
    
    <aside class="sidebar">
        <div class="tags-cloud">
            <h3>–í—Å–µ —Ç–µ–≥–∏</h3>
            <div class="tags-list">
                {% for tag in all_tags %}
                <a href="{% url 'news:articles_by_tag' tag.slug %}" class="tag" style="background-color: {{ tag.color }}">
                    {{ tag.name }}
                </a>
                {% endfor %}
            </div>
        </div>
    </aside>
</div>
{% endblock %}