<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}The game post{% endblock %}</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'news/css/styles.css' %}">
</head>
<body>
    <header class="site-header">
        <div class="container">
            <div class="header-top">
                <h1><a href="{% url 'news:article_list' %}">The game post</a></h1>
                <div class="user-menu">
                <button class="user-icon" onclick="toggleDropdown()">
                    üë§
                </button>
                <div class="dropdown-menu" id="dropdownMenu">
                    {% if user.is_authenticated %}
                        <div class="user-greeting">–ê–∫–∫–∞—É–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {{ user.username }}!</div>
                        <a href="{% url 'news:logout' %}">üö™ –í—ã–π—Ç–∏</a>
                    {% else %}
                        <a href="{% url 'news:login' %}">üîë –í–æ–π—Ç–∏</a>
                        <a href="{% url 'news:register' %}">üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
        
        <nav class="main-nav">
            <div class="container">
                <ul class="nav-menu">
                    <li><a href="{% url 'news:article_list' %}" {% if not current_category %}class="active"{% endif %}>–í—Å–µ –Ω–æ–≤–æ—Å—Ç–∏</a></li>
                    <li><a href="{% url 'news:articles_by_category' 'novosti' %}" {% if current_category and current_category.slug == 'novosti' %}class="active"{% endif %}>–ù–æ–≤–æ—Å—Ç–∏</a></li>
                    <li><a href="{% url 'news:articles_by_category' 'igry' %}" {% if current_category and current_category.slug == 'igry' %}class="active"{% endif %}>–ò–≥—Ä—ã</a></li>
                    <li><a href="{% url 'news:articles_by_category' 'stati' %}" {% if current_category and current_category.slug == 'stati' %}class="active"{% endif %}>–°—Ç–∞—Ç—å–∏</a></li>
                    <li><a href="{% url 'news:about' %}" {% if request.resolver_match.url_name == 'about' %}class="active"{% endif %}>–û —Å–∞–π—Ç–µ</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <div class="overlay" id="overlay" onclick="closeDropdown()"></div>

    <main class="container">
        {% if messages %}
        <div class="messages">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% block content %}
        {% endblock %}
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2025 The game post. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        </div>
    </footer>

<script>
function toggleDropdown() {
    const dropdown = document.getElementById('dropdownMenu');
    const overlay = document.getElementById('overlay');
    
    if (dropdown.classList.contains('show')) {
        closeDropdown();
    } else {
        dropdown.classList.add('show');
        overlay.style.display = 'block';
    }
}

function closeDropdown() {
    const dropdown = document.getElementById('dropdownMenu');
    const overlay = document.getElementById('overlay');
    
    dropdown.classList.remove('show');
    overlay.style.display = 'none';
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
document.addEventListener('click', function(event) {
    const dropdown = document.getElementById('dropdownMenu');
    const userIcon = document.querySelector('.user-icon');
    const overlay = document.getElementById('overlay');
    
    if (!userIcon.contains(event.target) && !dropdown.contains(event.target)) {
        closeDropdown();
    }
});

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ ESC
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        closeDropdown();
    }
});
</script>
</body>
</html>